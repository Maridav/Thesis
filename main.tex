\documentclass[12pt]{article}
\usepackage{fullpage}   
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{amsthm, amsmath, amssymb, pdfpages}

%\usepackage[left=3cm,right=1cm,
%   top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}



\renewcommand{\proofname}{Доказательство}
\theoremstyle{plain}
\newtheorem{thm}{Теорема} %[section], чтобы нумеровать сначала в каждом разделе
\newtheorem{lm}{Лемма}
\newtheorem*{st}{Утверждение}

\theoremstyle{definition}
\newtheorem*{defn}{Определение}
\newtheorem*{ex}{Упр}
\newtheorem{cor}{Следствие}
\newtheorem*{name}{Обозначение}

\theoremstyle{remark}
\newtheorem*{rem}{Замечание}


\def\geq{\geqslant}
\def\ge{\geqslant}
\def\leq{\leqslant}
\def\le{\leqslant}

\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\D}{D}
\DeclareMathOperator{\vol}{vol}

\newcommand{\cuplim}{\bigcup\limits}
\newcommand{\ilim}{\int\limits}
\newcommand{\slim}{\sum\limits}
\newcommand{\maxlim}{\max\limits}
\newcommand{\suplim}{\sup\limits}
\newcommand{\T}{\mathbb{T}}
\newcommand{\dm}{\, d\mu_n}
\newcommand{\R}{\mathbb{R}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\Z}{\mathbb{Z}}
%\newcommand{\R^nn}{\mathbb{R}^n}
%\newcommand{C^1}{\mathbb{C}^1}
\newcommand{\til}{\widetilde}
\newcommand{\dd}{\partial}
\newcommand{\eps}{\varepsilon}



\begin{document}\thispagestyle{empty}%Отсутствие нумерации на титульном листе

\centerline{\large Санкт-Петербургский государственный университет}

\vspace{5.5cm}

\begin{center}
{\bf\LARGE Кодирование случайных множеств в булевой модели с переменной интенсивностью}
\end{center}

\vspace{1.3cm}

{\parindent=9.2cm \large
	Дипломная работа \par
	студентки 4 курса \par
	направление «Математика» \par
	01.03.01.\par 
	группы 16.Б01$-$мм\par
	очной формы обучения \par
	Давыденковой Марии Сергеевны \par}

\vspace{1.1cm}

{\parindent=9.2cm \large
	Научный руководитель: \par
	д.ф.-м.н. профессор \par
	Лифшиц Михаил Анатольевич \par}

\vspace{4.0cm}
\begin{center}
	\large
	Санкт-Петербург \\
	2020 год
\end{center}

\tableofcontents

\section{Введение}
\subsection{Постановка задачи}

Пусть $S$  --  случайный элемент некоторого метрического пространства $(X, dist)$.
Средней ошибкой дискретизации $S$ называется величина  $$D^{(q)}(r) := \inf\limits_{\#\mathcal{C}\leq e^r}\E \min\limits_{A\in\mathcal{C}}dist(S, A), \quad r>0.$$ 
Скорость ее убывания при  стремлении $r$ к бесконечности характеризует сложность распределения $S$. 
Общие свойства величины $D^{(q)}(r)$ изучены в \cite{GL, CT, Kolm}.
В последние два десятилетия ошибки дискретизации исследовались, в основном,
для траекторий случайных процессов, рассматриваемых как случайный элемент функционального пространства, см., например, \cite{ADSV, Der}. 

В работе \cite{AL} изучалась ошибка дискретизации для случайного множества,
рассматриваемого как случайный элемент пространства компактов, снабжённого метрикой Хаусдорфа $d_H(A, B) := \max(\sup_{a\in A}\inf_{b\in B}\|a - b\|, \sup_{b\in B}\inf_{a\in A}\|a - b\|)$.
В качестве случайного множества была взята стандартная Булева модель (Boolean model, см. \cite{CSKM, SW}), которая
устроена следующим образом.

Рассмотрим куб $[0,a]^d$ в $\R^d$, $d \geq 1$, и  случайный набор шаров с центрами в этом кубе, определенный следующим образом: пусть  центры шаров $\xi_i$ ---  случайные величины, распределенные равномерно в $[0,a]^d$, радиусы $R_i$ --- некоторые одинаково распределенные неотрицательные случайные величины, а количество шаров $N$ --- пуассоновская случайная величина с параметром $a^d\lambda$, где $\lambda = \lambda(a)$ -- положительный параметр, зависящий от $a$. Все эти случайные величины независимы. Отметим, что при таком построении множество $(\xi_i)_{i\leq N}$ --- это пуассоновский точечный процесс с интенсивностью $\lambda$.

Обозначим через $B(\xi_i, R_i)$ шар с центром в $\xi_i$ радиуса $R_i$ (пока что мы не фиксируем норму в $\R^d$).
Мы будем рассматривать  ``картинку'', образованную этим наборов шаров:
$$S_a = \cuplim_{i=1}^N B(\xi_i, R_i) \cap [0,a]^d.$$

Определенная таким образом картинка называется {\it Булевой моделью случайного множества}.
Заметим, что свойства $S_a$ будут зависеть от рассматриваемой нормы.

 В работе \cite{AL} исследовался случай $a=1$ с постоянной интенсивностью $\lambda$. Результаты   основаны на изучении вероятностей  больших уклонений величины  $$K_1 = \min \{r \geq 1 | \exists i_1, \ldots , i_r \subset \{1, \ldots , N\} : S_1 = \cuplim_{l=1}^r B(\xi_{i_l}, R_{i_l}) \cap [0,a]^d\},$$
называемой {\it минимальным числом видимых шаров}, то есть на нахождении асимптотики $\PP[K_1 \geq n]$ при $n$, стремящемся к бесконечности. 

В настоящей работе некоторые из этих оценок распространяются на случай, когда параметр $a$ стремится к бесконечности, причем $n \gg a^d\lambda$.

Заметим, что тривиальная оценка, вытекающая из свойств пуассоновского распределения, такова:
\begin{multline*}
    \PP[K_a \geq n] \leq \PP[N\geq n] \sim \PP[N = n] =\\
    = \dfrac{(a^d\lambda)^n}{n!}e^{-a^d\lambda} \sim \left(\dfrac{ea^d\lambda}{n}\right)^ne^{-a^d\lambda}\sqrt{2\pi n} = 
    \exp(-n\log n + n\log (a^d\lambda) + O(n) ) = \\
    =\exp((-n\log n + dn\log a + n\log\lambda + 
    O(n))), \ n\to \infty, a \to\infty.
\end{multline*}{}
Условие $n\gg a^d\lambda$ гарантирует, что вероятность больших уклонений стремится к нулю, так как $-n\log(n/a^d\lambda)$ стремится к минус бесконечности с ростом $n$ и $a$. 

\subsection{Полученные результаты}
Получены более точные оценки вероятности больших уклонений для случаев постоянного радиуса и для радиусов с плотностью $p(z) \approx z^{\alpha -1}$ для $z\to 0$. Запись $p(z) \approx q(z), z\to 0$ обозначает, что $p(z)/q(z)$ ограничено вне любой окрестности нуля и бесконечно для достаточно малых $z$. Показано, что существует число $\beta >1$, для которого $$\PP[K_a \geq n] = \exp((-\beta\cdot n\log n + \beta\cdot dn\log a + n\log\lambda + O(n))), \ n\to \infty, a \to\infty.$$
Число $\beta$ зависит от размерности $d$, используемой нормы и распределения радиусов $R_i$.



%\section{Важная переформулировка}
%
%Рассмотрим следующую аналогичную переформулировку нашей задачи, которая, хоть и менее интуитивна, более приятна для работы. Будем рассматривать единичный куб в $\R^d$ и следующий случайный набор шаров с центрами в нём. Пусть центры шаров $\til{\xi_i}$ независимы и равномерно распределены в единичном кубе, радиусы $\til{R_i}$ --- некоторые независимые одинаково распределенные неотрицательные случайные величины (они связаны с исходными радиусами соотношениями $\til{R_i} = R_i/a$), а количество шаров $\til{N}$ --- пуассоновская случайная величина с параметром $a^d\lambda$. 
%
%Тогда наша случайная картинка определяется как $$\til{S_a} = \cuplim_{i=1}^N B(\til{\xi_i}, \til{R_i}) \cap [0,1]^d,$$ а минимальное число видимых шаров: $$K_a = \min \{r \geq 1 | \exists i_1, \ldots , i_r \subset \{1, \ldots , \til{N}\} : \til{S_a} = \cuplim_{l=1}^r B(\til{\xi_{i_l}}, \til{R_{i_l}}) \cap [0,1]^d\}.$$
%
%Задача оценки остается такой же.

\input{lambdatozero}

\section{Нижние оценки для вероятности больших уклонений}

\subsection{Постоянный радиус}

Рассмотрим случай, когда радиусы -- это константа $r>0$ п.н. 

\begin{thm}\label{lowconst1}
Пусть $R_1\equiv r > 0$ п.н., где шары берутся в $\ell_1$-норме, $d\geq 2$, $n \gg a^d\lambda$, и $n\gg a^d$. 
Тогда $$\PP[K_a \geq n] \geq \exp \left(-\left(1+\dfrac{1}{d-1}\right)n\log n + \left(1+\dfrac{1}{d-1}\right)dn\log a  + n\log\lambda + O(n)\right),\  n, a\to \infty.$$
\end{thm}{}

\begin{proof}
    Рассмотрим набор ячеек: 
    \begin{multline*}
        \prod\limits_{m=1}^{d-1}\left[\dfrac{a^{d/(d-1)}(k_m+1/4)}{(8rn)^{1/(d-1)}}, \dfrac{a^{d/(d-1)}(k_m+3/4)}{(8rn)^{1/(d-1)}}\right]
    \times \\
    \times \left[l\left(\dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}} +2r\right) ,  l\left(\dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}}+2r\right) + \dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}}  \right],
    \end{multline*}{}
    где $k_m \in \{0, \ldots, \lfloor (8rn/a)^{1/(d-1)}\rfloor-1\}$, $l\in \left\{0, \ldots, \lfloor a/4r\rfloor\right\}$, $c_1 = 2^{-(2+3/(d-1))}$. 
    
    Все эти ячейки лежат в кубе $[0,a]^d$. По первым $d-1$ координатам это очевидно, проверим по последней. Действительно, 
    \begin{equation*}
        \dfrac{a}{4r}\cdot\left(\dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}}+2r\right) + \dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}} %= \\
        %= \dfrac{c_1a^{1 + d/(d-1)}}{4r(rn)^{1/(d-1)}} + \dfrac{c_1a^{1/(d-1)}}{(rn)^{1/(d-1)}} + \dfrac{a}{2}% = \\
        = \dfrac{c_1a^{d/(d-1)}}{r(rn)^{1/(d-1)}}\cdot\left(\dfrac{a}{4} + r\right) + \dfrac{a}{2}
        < a
    \end{equation*}{}
    при достаточно больших $a$ и $n$ в силу того, что $n \gg a^d$.
    
    Заметим, что если центры шаров $B(\xi_i, r)$, $B(\xi_j, r)$ лежат в разных ``рядах'', то есть $\xi_i^{(d)}$ и $\xi_j^{(d)}$ лежат в разных выбранных нами интервалах, то эти шары не пересекаются, так как расстояние между ``рядами'' хотя бы $2r$. Если же центры лежат в одном ``ряду'', то в каждом из шаров есть точка, не покрытая другим шаром. Действительно, рассмотрим точку  $x_i = \xi_i + (0, \ldots, 0, r)$. Заметим, что для достаточно больших $n$ и $a$ эта точка действительно лежит в кубе $[0, a]^d$. Итак, при $j \not= i$
    \begin{multline*}
        \|x_i - \xi_j\|_1 = 
        |\xi_i^{(d)} + r - \xi_j^{(d)} | + \sum_{m=1}^{d-1}|\xi_i^{(m)} - \xi_j^{(m)}| \geq\\
        \geq r - |\xi_i^{(d)} - \xi_j^{(d)} | + \sum_{m=1}^{d-1}|\xi_i^{(m)} - \xi_j^{(m)}| \geq
        r - \dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}} + \dfrac{1/2\cdot a^{d/(d-1)}}{(8rn)^{1/(d-1)}} > r.
    \end{multline*}{}
    
    
    Мы построили порядка $8rn/a \cdot a/4r = 2n$ непересекающихся ячеек, поэтому можно выбрать $n$ из них. Назовем их $V_1, \ldots, V_n$  и рассмотрим событие $$E = \{N=n\}\cap \bigcap\limits_{\pi \text{ -- перестановка } \{1, \ldots, n\}} \{\xi_i \in V_{\pi(i)}, i = 1, \ldots, n\}.$$
                         
    Заметим, что событие $E$ влечет событие $\{K \geq n\}$ в силу свойств выбранных ячеек, показанных выше.
  
    Следовательно, 
    \begin{multline*}
        \PP[K_a\geq n] \geq \PP[E] = \dfrac{(a^d\lambda)^n}{n!}e^{-a^d\lambda}\cdot n!\cdot \left(\dfrac{1}{a^d}\cdot\left(\dfrac{1/2\cdot a^{d/(d-1)}}{(8rn)^{1/(d-1)}}\right)^{d-1}\cdot \dfrac{c_1a^{d/(d-1)}}{(rn)^{1/(d-1)}}\right)^n = \\
        =\exp\left(dn\log a + n\log\lambda - a^d\lambda - \left(1+\dfrac{1}{d-1}\right)n\log n + \dfrac{d}{d-1} n\log a  + O(n)\right) =\\
        =\exp\left(-\left(1 + \dfrac{1}{d-1}\right)n\log n + \left(1 + \dfrac{1}{d-1}\right)dn\log a + n\log\lambda + O(n)\right).
    \end{multline*}{}
\end{proof}{}

\begin{thm}\label{lowconst2}
Пусть $R_1\equiv r > 0$ п.н., где шары берутся в $\ell_2$-норме, $d\geq 2$,  $n \gg a^d\lambda$, и $n\gg a^d$. 
Тогда $$\PP[K_a \geq n] \geq \exp \left(-\left(1+\dfrac{2}{d-1}\right)n\log n + \left(1+\dfrac{2}{d-1}\right)dn\log a  +n\log\lambda + O(n)\right),\  n, a\to \infty.$$
\end{thm}{}

Доказательство теоремы аналогично случаю $\ell_1$-нормы, и отличается только размером ячеек.
\begin{proof}
    Рассмотрим набор ячеек: 
    \begin{multline*}
        \prod\limits_{m=1}^{d-1}\left[\dfrac{a^{d/(d-1)}(k_m+1/4)}{(8rn)^{1/(d-1)}}, \dfrac{a^{d/(d-1)}(k_m+3/4)}{(8rn)^{1/(d-1)}}\right]
    \times \\
    \times \left[l\left(\dfrac{c_2a^{2 + 2/(d-1)}}{r(rn)^{2/(d-1)}} +2r\right) ,  l\left(\dfrac{c_2a^{2 + 2/(d-1)}}{r(rn)^{2/(d-1)}}+2r\right) + \dfrac{c_2a^{2 +2/(d-1)}}{r(rn)^{2/(d-1)}}  \right],
    \end{multline*}{}
    где $k_m \in \{0, \ldots, \lfloor (8rn/a)^{1/(d-1)}\rfloor-1\}$, $l\in \left\{0, \ldots, \lfloor a/4r\rfloor\right\}$, $c_2 = 2^{-(4+6/(d-1))}$. 
    
    Все эти ячейки лежат в кубе $[0,a]^d$. По первым $d-1$ координатам это очевидно, проверим по последней. Действительно, 
    \begin{equation*}
        \dfrac{a}{4r}\left(\dfrac{c_2a^{2 + 2/(d-1)}}{r(rn)^{2/(d-1)}}+2r\right) + \dfrac{c_2a^{2 +2/(d-1)}}{r(rn)^{2/(d-1)}} 
        =\dfrac{c_2a^{2+ 2/(d-1)}}{r^2(rn)^{2/(d-1)}}\cdot\left(\dfrac{a}{4} + r\right) + \dfrac{a}{2} 
        < a
    \end{equation*}{}
    при достаточно больших $a$ и $n$ в силу того, что $n \gg a^d$.
    
    Заметим, что если центры шаров $B(\xi_i, r)$, $B(\xi_j, r)$ лежат в разных ``рядах'', то есть $\xi_i^{(d)}$ и $\xi_j^{(d)}$ лежат в разных выбранных нами интервалах, то эти шары не пересекаются, так как расстояние между ``рядами'' хотя бы $2r$. Если же центры лежат в одном ``ряду'', то в каждом из шаров есть точка, не покрытая другим шаром. Действительно, рассмотрим точку  $x_i = \xi_i + (0, \ldots, 0, r)$. Заметим, что для достаточно больших $n$ и $a$ эта точка действительно лежит в кубе $[0, a]^d$. Итак, при $j \not= i$
        \begin{multline*}
        \|x_i - \xi_j\|^2_2 = 
        |\xi_i^{(d)} + r - \xi_j^{(d)} |^2 + \sum_{m=1}^{d-1}|\xi_i^{(m)} - \xi_j^{(m)}|^2 \geq\\
        \geq r^2 - 2r|\xi_i^{(d)} - \xi_j^{(d)}| + (\xi_i^{(d)} - \xi_j^{(d)})^2  + \sum_{m=1}^{d-1}|\xi_i^{(m)} - \xi_j^{(m)}|^2 \geq \\
        \geq r^2 - \dfrac{2c_2a^{2+2/(d-1)}}{(rn)^{2/(d-1)}} + \left(\dfrac{1/2a^{d/(d-1)}}{(8rn)^{1/(d-1)}}\right)^2 \geq r^2.
    \end{multline*}{}
    
    
    Мы построили порядка $8rn/a \cdot a/4r = 2n$ непересекающихся ячеек, поэтому можно выбрать $n$ из них. Назовем их $V_1, \ldots, V_n$  и рассмотрим событие $$E = \{N=n\}\cap \bigcap\limits_{\pi \text{ -- перестановка } \{1, \ldots, n\}} \{\xi_i \in V_{\pi(i)}, i = 1, \ldots, n\}.$$
                         
    Заметим, что событие $E$ влечет событие $\{K \geq n\}$ в силу свойств выбранных ячеек, показанных выше.
  
    Следовательно, 
    \begin{multline*}
        \PP[K_a\geq n] \geq \PP[E] = \dfrac{(a^d\lambda)^n}{n!}e^{-a^d\lambda}\cdot n!
        \cdot \left(\dfrac{1}{a^d}\cdot\left(\dfrac{1/2\cdot a^{d/(d-1)}}{(8rn)^{1/(d-1)}}\right)^{d-1}\cdot
        \dfrac{c_2a^{2+ 2/(d-1)}}{r(rn)^{2/(d-1)}}\right)^n = \\
        =\exp\left(dn\log a + n\log\lambda - a^d\lambda - \left(2+\dfrac{2}{d-1}\right)n\log n + \left(2+\dfrac{2}{d-1}\right) n\log a  + O(n)\right) = \\
        =\exp\left(-\left(1+ \dfrac{2}{d-1}\right)n\log n + \left(1 + \dfrac{2}{d-1}\right)dn\log a + n\log\lambda + O(n)\right).
    \end{multline*}{}
\end{proof}{}

%\begin{thm}
%Пусть $R_1\equiv \dfrac{r}{a}$ п.н., где $r<1$, шары берутся в $l_\infty$-норме, и $d\geq 2$. Тогда $$\PP[K_a \geq n] \geq \exp \left(\left(-\left(1+\dfrac{1}{d-1}\right)n\log n + dn\log a \right)(1 + o(1))\right), n \to \infty, a\to \infty.$$
%\end{thm}{}
%
%\begin{proof} 
%Зафиксируем $\rho_1, \rho_2$, такие, что $r<\rho_1<\rho_2<1$. Заметим, что тогда $r/a<\rho_1<\rho_2<1$ для любого $a\geq 1$. Далее сделаем все то же самое, что в статье. Рассмотрим гиперплоскость $$H = \left\{x\in[0, 1]^d \colon \slim_{m=1}^dx^{(m)} = d\rho_2, \min\limits_{1\leq m \leq d}x^{(m)}>\rho_1\right\}.$$ 
%Для достаточно малой константы $c_1$ выберем $n$ точек $\beta_1, \ldots, \beta_n$ из $H$, чтобы выполнялось $\|\beta_i - \beta_j\|_1 > c_1n^{1/(d-1)}$ для всех $i\not= j$. Теперь рассмотрим ячейки $V_i = B(\beta_i, c_2n^{-1/(d-1)})$, где $c_2 < c_1/(4d)$. И определим следующее событие $$E = \{N = n\} \cap  \bigcup\limits_{\pi \text{ -- перестановка } \{1, \ldots, n\}} \{\xi_i \in V_{\pi(i)}, i = 1, \ldots, n\}.$$
%Затем показывается, что из события $E$ следует событие $K_a \geq n$. В итоге получаем:
%\begin{multline*}
%    \PP[K_a \geq n] \geq \PP[E] = \dfrac{a^d\lambda}{n!}e^{-a^d\lambda}\cdot n!\cdot \left(c_2n^{-1/(d-1)}\right)^dn = \\
%    =\exp \left(\left(-\left(1+\dfrac{1}{d-1}\right)n\log n + dn\log a\right)(1+o(1))\right).
%\end{multline*}{}
%\end{proof}{}

\subsection{Радиус с плотностью}
Утверждение следующей теоремы верно для произвольной нормы в $\R^d$.

\begin{thm}\label{lowdens}
Пусть распределение $R_1$ имеет плотность $p$ относительно меры Лебега, причем $p(z) \geq c z^{\alpha -1}$ для малых $z$ и некоторых $c, \alpha >0$. Предположим, что $d \geq 1$ и $n \gg a^d\lambda$.
Тогда $$\PP[K_a \geq n] \geq \exp\left(-\left(1 + \alpha/d\right)n\log n + (1 + \alpha/d)dn\log a + n\log \lambda + O(n)\right), \ n, a \to \infty.$$
\end{thm}{}





\begin{proof}
Рассмотрим набор ячеек:
\begin{equation*}
    \prod_{m = 1}^d \left[\dfrac{a(k_m + 1/4)}{(2n)^{1/d}},\ \dfrac{a(k_m + 3/4)}{(2n)^{1/d}}\right],
\end{equation*}{}
где $k_m\in \{0, \ldots \lfloor(2n)^{1/d}\rfloor - 1\}$.

Мы построили порядка $2n$ непересекающихся ячеек, поэтому можно выбрать $n$ из них. Назовем их $V_1, \ldots, V_n$  и рассмотрим событие 
\begin{equation*}
    E = \{N=n\}\cap \bigcap\limits_{\pi \text{ -- перестановка } \{1, \ldots, n\}} \{\xi_i \in V_{\pi(i)}, R_i \in [c_1an^{-1/d}, c_2an^{-1/d}],  i = 1, \ldots, n\},
\end{equation*}
где $c_2 > c_1> 0$ -- некоторые константы, которые могут зависеть от нормы и размерности, причем $c_2$ выбирается так, чтобы для $i\not=j$ шары $B(\xi_i, R_i)$ и $B(\xi_j, R_j)$ не пересекались. В этом случае событие $E$ влечет $\{K_a \geq n\}$.

Следовательно, 
\begin{multline*}
    \PP[K \geq n] \geq \PP[E] = \dfrac{(a^d\lambda)^n}{n!}e^{-a^d\lambda}\cdot n! \cdot \left(\dfrac{1}{a^d}\left(\dfrac{1/2 \cdot a}{(2n)^{1/d}}\right)^d\cdot \int_{c_1an^{-1/d}}^{c_2an^{-1/d}} p(z) dz\right)^n \geq \\
    \geq (a^d\lambda)^n e^{-a^d\lambda} \cdot \left(\left(\dfrac{1/2 }{(2n)^{1/d}}\right)^d\cdot c \int_{c_1an^{-1/d}}^{c_2an^{-1/d}} z^{\alpha - 1} dz\right)^n = \\
    = (a^d\lambda)^n e^{-a^d\lambda} \cdot \left(\left(\dfrac{1/2 }{(2n)^{1/d}}\right)^d\cdot c (c_2^\alpha - c_1^\alpha)/\alpha \cdot a^\alpha n^{-\alpha/d}\right)^n = \\
    = \exp\left(-(1 + \alpha/d)n\log n + (1 + \alpha/d)dn\log a + n\log\lambda + O(n)\right).
\end{multline*}{}
\end{proof}{}

\section{Верхние оценки для вероятности больших уклонений}

\begin{thm}\label{uppconst1}
Пусть $R_1\equiv r > 0$ п.н., где шары берутся в $\ell_1$-норме, $d\geq 2$,  $n \gg a^d\lambda$, и $n\gg a^d$. 
Тогда $$\PP[K_a \geq n] \leq \exp \left(-\left(1+\dfrac{1}{d-1}\right)n\log n + \left(1 + \dfrac{1}{d-1}\right)dn\log a  + n\log\lambda + O(n)\right), n, a\to \infty.$$
\end{thm}{}



\begin{proof}
{\it Шаг 1. Объединение шаров в группы.} Пусть $$S = \bigcup_{i=1}^{K_a} B(\xi_i, r) \cap [0,a]^d$$ обозначает неуменьшаемое представление картинки $S$. Тогда для каждого числа $i\leq K_a$ существует точка $\nu_i\in B(\xi_i, r) \cap [0,a]^d$, которая не лежит ни в каком другом шаре $B(\xi_j, r), j \not= i$. Зафиксируем такие $\nu_i, i = 1, 2, \ldots K_a$. Обозначим $\Delta_i := \nu_i - \xi_i$.

Объединим шары в группы $J_0, J_1^+, J_1^-, \ldots J_d^+, J_d^-$ следующим образом. Определим $J_0 := \{i \colon \|\Delta_i\|_1 \leq r/2\}$. Оценим мощность этого множества. Для любых $i, j \in J_0$ выполнено:
$$r < \|\nu_j - \xi_i\| \leq \|\nu_j - \nu_i\| + \|\nu_i - \xi_i\| \leq 
\|\nu_j - \nu_i\| + \|\Delta_i\| \leq \|\nu_j - \nu_i\| + r/2.$$
То есть $\|\nu_j-\nu_i\|> r/2$, а значит, $\#J_0 \leq  c_1r^{-d}a^d$, где константа $c_1~=~2^d/\vol_d B(0,1).$

Теперь пусть $i\not\in J_0$. Значит, $$\|\Delta_i\|_\infty \geq c_2\|\Delta_i\|_1 > c_2r/2.$$ Поэтому $i$ принадлежит одному из $2d$ множеств вида: $$J_m^+ := \{i\colon \Delta_i^{(m)} > c_2r/2\}, \quad J_m^- := \{i\colon \Delta_i^{(m)} < - c_2r/2\}, \quad 1\leq m\leq d.$$

{\it Шаг 2. Оценка расстояний между центрами.} Пусть $\sigma \colon \R^d \to \R^d$ -- проекция, определенная таким образом: $$\sigma x := (x^{(1)}, \ldots x^{(d-1)}, 0).$$ 

\begin{lm}[см. \cite{AL}, Lemma 20]
Пусть $i, j\in J_d^+, \ i\not= j$, и пусть $c_3 := c_2 r/2.$ Тогда $$|\xi_i^{(d)} - \xi_j^{(d)}| \not\in [\|\sigma\xi_i - \sigma\xi_j\|_1, c_3].$$
\end{lm}{}

{\it Шаг 3. Подсчет ячеек, содержащих центры шаров.} 
Зафиксируем большое число $A > 0$ и покроем куб $[0, a]^d$ следующим набором ячеек: $$V_{\bar k, k_d} := \prod_{m = 1}^d\left[\dfrac{Ak_m}{(na^{-d})^{1/(d-1)}}, \dfrac{A(k_m+1)}{(na^{-d})^{1/(d-1)}}\right],$$
где $k_m\in \{0, \ldots, \lfloor A^{-1}(na^{-1})^{1/(d-1)}\rfloor\}$ для $1\leq m \leq d$ и мульти-индекса $\bar k := (k_1, \ldots, k_{d-1}).$

Зафиксируем некоторый индекс $\bar k$ и оценим количество ячеек, содержащих центры шаров: $$N(\bar k, d, +):= \#\{k\colon \xi_i\in V_{\bar k, k} \text{ для некоторого } i\in J_d^+\}.$$

Заметим, что если $\xi_i\in V_{\bar k, \kappa_i}$ и $\xi_j\in V_{\bar k, \kappa_j}$ для некоторых $i, j\in J_d^+$, то $$\|\sigma\xi_i - \sigma\xi_j\|_1~\leq~(d-1)A(na^{-d})^{-1/(d-1)}.$$ 
Поэтому по лемме $$|\xi_i^{(d)} - \xi_j^{(d)}| \not\in [(d-1)A(na^{-d})^{-1/(d-1)}, c_3].$$

{\it {\bf Замечание.} При достаточно больших $a, n$ этот интервал корректно определен.}

Исходя из этого, разобъем $[0,a]$ на $a\lceil c_3^{-1}\rceil$ частей длины не более $c_3$, и заметим, что если $\xi_i^{(d)}, \xi_j^{(d)}$ лежат в одной части, то $|\xi_i^{(d)} - \xi_j^{(d)}| \leq (d-1)A(na^{-d})^{-1/(d-1)}$. Поэтому тогда $|\kappa_i - \kappa_j|\leq d$. Отсюда получаем искомую оценку: $$N(\bar k, d, +)\leq ad \lceil c_3^{-1}\rceil =: ac_4.$$

Теперь мы можем получить общее число ячеек, содержащих центры: $$\sum_{\bar k}\sum_{m=1}^d (N(\bar k, m, +) + N(\bar k, m, -))\leq (2d)\cdot(ac_4)\cdot (na^{-1}A^{-(d-1)}) =: \dfrac{c_5 n}{A^{d-1}}.$$

Пусть $\mathcal{U}$ -- семейство всех возможных объединений из $\left\lfloor \dfrac{c_5 n}{A^{d-1}}\right\rfloor$ ячеек. Их количество -- число способов выбрать $\left\lfloor \dfrac{c_5 n}{A^{d-1}}\right\rfloor$ ячеек из $\left\lceil \dfrac{n^{d/(d-1)}}{a^{d/(d-1)}A^d}\right\rceil$. Поэтому можно выписать следующую простую оценку: \begin{multline*}
    \#\mathcal{U}\leq \exp \left(\dfrac{c_5 n}{A^{d-1}} \log \left\lceil \dfrac{n^{d/(d-1)}}{a^{d/(d-1)A^d}}\right\rceil \right) = \\
    =\exp \left(\dfrac{c_5d}{(d-1)A^{d-1}}n\log n + \dfrac{c_5}{(d-1)A^{d-1}}dn\log a + o(n)\right).
\end{multline*}{}

Для каждого $U\in \mathcal{U}$ объем можно оценить так: $$\vol_d (U)\leq \dfrac{c_5n}{A^{d-1}}\left(\dfrac{Aa^{d/(d-1)}}{n^{1/(d-1)}}\right)^d = \dfrac{Ac_5a^{d^2/(d-1)}}{n^{1/(d-1)}}.$$

{\it Шаг 4. Оценка вероятности.} Напомним, что $$K_a = \#J_0 + \#\left(\bigcup_{m=1}^d (J_m^+ \cup J_m^-)\right) =: K^{(0)} + K^{(\pm)}.$$
Заметим, что для некоторого случайного множества $U\in\mathcal{U}$ выполнено: $$N_U := \#\{i\colon \xi_i\in U\} \geq K^{(\pm)}.$$

Пусть $c_6 := c_1r^{-d}$. Тогда, как мы помним, $K^{(0)}\leq c_6a^d.$

Поэтому, пользуясь тем, что случайная величина $N_U$  имеет распределение Пуассона с математическим ожиданием $\lambda\vol_d(U)$, получаем следующую оценку: 
\begin{multline*}
    \PP[K_a\geq n] \leq \PP[K^{(\pm)} \geq n-c_6a^d] \leq \sum_{U\in\mathcal{U}}\PP[N_U \geq n-c_6a^d] \leq
    \#\mathcal{U}\cdot\max_{U\in\mathcal{U}}\PP[N_U\geq n- c_6a^d] \leq \\
    \leq  \exp \left(\dfrac{c_5d}{(d-1)A^{d-1}}n\log n + \dfrac{c_5}{(d-1)A^{d-1}}dn\log a + o(n)\right) \left(\dfrac{\lambda\vol_d(U)e}{n-c_6a^d}\right)^{n-c_6a^d} \leq \\
    \leq 
    \exp \left(\dfrac{c_5d}{(d-1)A^{d-1}}n\log n + \dfrac{c_5}{(d-1)A^{d-1}}dn\log a + o(n)\right)\cdot\\
    \cdot\left(\dfrac{\lambda Ac_5a^{d^2/(d-1)}en^{-1/(d-1)}}{n-c_6a^d}\right)^{n-c_6a^d}
\end{multline*}

Распишем отдельно последнюю скобку:
\begin{multline*}
    \left(\dfrac{\lambda Ac_5a^{d^2/(d-1)}en^{-1/(d-1)}}{n-c_6a^d}\right)^{n-c_6a^d} = \\
    = \exp\left(n\log\lambda + d^2/(d-1)n\log a - 1/(d-1)n\log n - n\log(n-c_6a^d) -\right.\\
    \left.- c_6a^d\log\lambda - c_6a^dd^2/(d-1)\log a + c_6a^d/(d-1)\log n + c_6a^d\log (n-c_6a^d) + O(n)\right).
\end{multline*}

Заметим, что $\log (n - c_6a^d) = \log n + o(1).$\\ Слагаемое $c_6a^d\log\lambda = o(n)$, и $- c_6a^dd^2/(d-1)\log a - c_6a^d(1+1/(d-1))\log n < 0$.

Итак,
\begin{multline*}
    \PP[K_a\geq n]\leq
     \exp\left(\left(\dfrac{c_5d}{(d-1)A^{d-1}} - 1 - \dfrac{1}{d-1}\right)n\log n + \right.\\
    +\left.\left(\dfrac{c_5}{(d-1)A^{d-1}} + 1 + \dfrac{1}{d-1}\right)dn\log a + n\log \lambda + O(n) \right).
\end{multline*}{}





Так как константа $A$ может быть выбрана сколь угодно большой, получаем:
\begin{equation*}
    \PP[K_a \geq n] \leq 
     \exp \left(-\left(1+\dfrac{1}{d-1}\right)n\log n + \left(1+\dfrac{1}{d-1}\right)dn\log a + n\log \lambda + O(n) \right).
\end{equation*}{}
\end{proof}{}

\section{Связь с задачей постоянного размера куба}

В этом разделе мы покажем, как получить оценки вероятности больших уклонений с параметром $a\to \infty$ из соответствующих оценок для случая  $a=1$. 

\subsection{Нижние оценки}
Утверждение следующей теоремы выполнено для произвольной нормы.
\input{Lower_bounds}

\subsection{Верхние оценки}
\input{Upper_bounds}

\section{Вероятность больших уклонений в одномерном случае}

Доказательства дальнейших оценок основаны на следующей лемме.

\begin{lm}

\end{lm}

\begin{thm}
Пусть $d=1$. Предположим, что распределение $R_1$ имеет плотность $p(z)\approx z^{\alpha-1}$ для $z\to 0$ и некоторого $\alpha > 0$. Тогда 
\begin{equation*}
    \PP[K_a\geq n] = \exp(-(1+\alpha)n\log n + (1+\alpha)dn\log a + n\log\lambda +O(n)), n,a \to\infty.
\end{equation*}
\end{thm}

\begin{proof}
Нижняя оценка доказана в теореме \ref{lowdens}. Для получения верхней оценки посмотрим на доказательство theorem 1 в \cite{AL}. Из него видно, что есть оценка
\begin{equation*}
    \PP[K_1 \geq n] \leq (-(1+\alpha)n\log n + n\log\lambda + O(n)), n\to\infty.
\end{equation*}
Применяя теорему \ref{uppgen}, получаем требуемое.
\end{proof}


%\begin{thm}
%Пусть $R_1\equiv \dfrac{c}{a}$ п.н., где $c<1$, шары берутся в $l_2$-норме, и $d\geq 2$. Тогда $$\PP[K_a \geq n] \leq \exp \left(\left(-\left(1+\dfrac{1}{d-1}\right)n\log n + (d+2)n\log a \right)(1 + o(1))\right), n \to \infty, a\to \infty.$$
%\end{thm}{}

%{\it \% Как-то тут совсем все не сходится.}

%\begin{proof}
%Аналогично случаю $l_1$, как и в статье. 
%\end{proof}{}


\begin{thebibliography}{99}
{\baselineskip=12pt
\bibitem{ADSV}
F.~Aurzada, S.~Dereich, M.~Scheutzow, C.~Vormoor, High resolution quantization and entropy coding of jump processes, J.
Complexity 25 (2) (2009) 163–187.\\

\bibitem{AL}
F.~Aurzada, M.~Lifshits, How complex is a random picture? Journal of Complexity 53 (2019) 133–161.\\

\bibitem{CSKM}
 S.N.~Chiu, D.~Stoyan, W.S.~Kendall, J.~Mecke, Stochastic Geometry and its Applications, Wiley Series in Probability and
Statistics, third ed., John Wiley \& Sons, Ltd., Chichester, 2013, p. xxvi+544.\\

\bibitem{CT}
T.M.~Cover, J.A.~Thomas, Elements of Information Theory, second ed., Wiley-Interscience [John Wiley \& Sons], Hoboken,
NJ, 2006, p. xxiv+748.\\

\bibitem{Der}
S.~Dereich, The coding complexity of diffusion processes under supremum norm distortion, Stochastic Process. Appl. 118
(6) (2008) 917–937.\\

\bibitem{GL}
S.~Graf, H.~Luschgy, Foundations of Quantization for Probability Distributions, Lecture Notes in Mathematics, vol. 1730,
Springer-Verlag, Berlin, 2000, p. x+230.\\


\bibitem{Kolm}
A.N.~Kolmogorov, Three approaches to the quantitative definition of information, Int. J. Comput. Math. 2 (1968) 157–168.\\




\bibitem{SW}
R.~Schneider, W.~Weil, Stochastic and Integral Geometry, Probability and its Applications (New York), Springer-Verlag,
Berlin, 2008, p. xii+693.
}
\end{thebibliography}







\end{document}
